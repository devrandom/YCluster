#!/bin/bash

# Generate SSH-only config from etcd
if ! /usr/local/bin/rathole-config generate-ssh-client > /etc/rathole/ssh-client.toml; then
    echo "Failed to generate rathole SSH client config from etcd"
    exit 1
fi

# Start rathole with generated config
exec /usr/local/bin/rathole /etc/rathole/ssh-client.toml
