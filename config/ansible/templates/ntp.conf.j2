# Ansible managed ntp.conf for cluster nodes

# Local NTP server - primary time source
server {{ ntp_server | default('10.0.0.254') }}{% if ntp_port | default(123) != 123 %} port {{ ntp_port }}{% endif %} iburst prefer

{% if ntp_fallback | default(true) %}
# Fallback to standard pools in case local server is unreachable
pool pool.ntp.org iburst
pool time.google.com iburst
{% endif %}

# Leap second file
leapfile /usr/share/zoneinfo/leap-seconds.list

# Drift file
driftfile /var/lib/ntpsec/ntp.drift

# Statistics path
statsdir /var/log/ntpsec/

# Logging
logfile /var/log/ntpsec/ntp.log

# Access control
restrict default kod nomodify notrap nopeer noquery
restrict 127.0.0.1
restrict ::1

# Local network access
restrict 10.0.0.0 mask 255.255.255.0 nomodify notrap
